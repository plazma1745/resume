<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Конструктор резюме для школьника</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #f0f4ff 0%, #e6f0ff 100%);
      margin: 0;
      padding: 20px;
      color: #333;
      line-height: 1.6;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    header {
      text-align: center;
      margin-bottom: 30px;
      padding: 25px;
      background: linear-gradient(to right, #4facfe 0%, #00f2fe 100%);
      border-radius: 15px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.1);
      color: white;
    }
    
    h1 {
      font-size: 2.5rem;
      margin-bottom: 10px;
      text-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    
    .subtitle {
      font-size: 1.2rem;
      opacity: 0.9;
      max-width: 700px;
      margin: 0 auto;
    }
    
    .form-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 25px;
    }
    
    @media (max-width: 900px) {
      .form-container {
        grid-template-columns: 1fr;
      }
    }
    
    .section {
      background: #fff;
      padding: 25px;
      margin-bottom: 20px;
      border-radius: 12px;
      box-shadow: 0 6px 15px rgba(0,0,0,0.08);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      border: 1px solid #e6f0ff;
    }
    
    .section:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(0,0,0,0.12);
    }
    
    .section h2 {
      margin-top: 0;
      margin-bottom: 20px;
      padding-bottom: 12px;
      border-bottom: 3px solid #4facfe;
      color: #2c3e50;
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 1.5rem;
    }
    
    .section h2 i {
      color: #4facfe;
      background: rgba(79, 172, 254, 0.1);
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #2c3e50;
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    .required::after {
      content: " *";
      color: #e74c3c;
    }
    
    input, textarea, select {
      width: 100%;
      padding: 12px 15px;
      margin-bottom: 15px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 16px;
      transition: border-color 0.3s, box-shadow 0.3s;
    }
    
    input:focus, textarea:focus, select:focus {
      outline: none;
      border-color: #4facfe;
      box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.2);
    }
    
    input.error, textarea.error, select.error {
      border-color: #e74c3c;
      box-shadow: 0 0 0 3px rgba(231, 76, 60, 0.2);
    }
    
    .row {
      display: flex;
      gap: 15px;
      margin-bottom: 15px;
    }
    
    .row > div {
      flex: 1;
    }
    
    .row > div:last-child {
      margin-bottom: 0;
    }
    
    button {
      background: linear-gradient(to right, #4facfe 0%, #00f2fe 100%);
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s;
      width: 100%;
      margin-top: 10px;
    }
    
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    
    button:active {
      transform: translateY(0);
    }
    
    button.add-btn {
      background: linear-gradient(to right, #00b09b 0%, #96c93d 100%);
      margin-top: 10px;
    }
    
    button.add-btn:hover {
      background: linear-gradient(to right, #009a87 0%, #7db82d 100%);
    }
    
    .export-buttons {
      display: flex;
      gap: 15px;
      margin-top: 20px;
    }
    
    .export-buttons button {
      flex: 1;
      margin-top: 0;
    }
    
    .export-buttons .pdf-btn {
      background: linear-gradient(to right, #e74c3c 0%, #c0392b 100%);
    }
    
    .export-buttons .pdf-btn:hover {
      background: linear-gradient(to right, #d62c1a 0%, #a52a20 100%);
    }
    
    .export-buttons .word-btn {
      background: linear-gradient(to right, #2980b9 0%, #1f618d 100%);
    }
    
    .export-buttons .word-btn:hover {
      background: linear-gradient(to right, #1f618d 0%, #1a5276 100%);
    }
    
    .expItem, .courseItem, .recItem {
      padding: 15px;
      border: 1px solid #eee;
      border-radius: 8px;
      margin-bottom: 15px;
      background: #f9f9f9;
      position: relative;
    }
    
    .expItem hr, .courseItem hr, .recItem hr {
      margin: 15px 0;
      border: 0;
      border-top: 1px solid #eee;
    }
    
    .remove-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      background: #ff416c;
      color: white;
      border: none;
      width: 26px;
      height: 26px;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
    }
    
    .remove-btn:hover {
      background: #e03a5f;
    }
    
    .info-icon {
      color: #4facfe;
      cursor: help;
    }
    
    .tooltip {
      position: relative;
      display: inline-block;
    }
    
    .tooltip .tooltip-text {
      visibility: hidden;
      width: 250px;
      background-color: #2c3e50;
      color: #fff;
      text-align: center;
      border-radius: 6px;
      padding: 10px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s;
      font-size: 14px;
      font-weight: normal;
      font-family: Arial, sans-serif;
    }
    
    .tooltip:hover .tooltip-text {
      visibility: visible;
      opacity: 1;
    }
    
    .tooltip .tooltip-text::after {
      content: "";
      position: absolute;
      top: 100%;
      left: 50%;
      margin-left: -5px;
      border-width: 5px;
      border-style: solid;
      border-color: #2c3e50 transparent transparent transparent;
    }
    
    footer {
      text-align: center;
      margin-top: 30px;
      padding: 20px;
      color: #7f8c8d;
      font-size: 0.9rem;
    }
    
    .validation-message {
      color: #e74c3c;
      font-size: 0.85rem;
      margin-top: -10px;
      margin-bottom: 15px;
      display: none;
    }
    
    .success-message {
      background-color: #d4edda;
      color: #155724;
      padding: 12px;
      border-radius: 8px;
      margin: 15px 0;
      display: none;
      text-align: center;
      font-weight: 500;
    }
    
    .icon-container {
      display: flex;
      gap: 15px;
      margin-top: 10px;
    }
    
    .icon-item {
      background: #f0f7ff;
      border-radius: 10px;
      padding: 10px;
      text-align: center;
      flex: 1;
      transition: transform 0.3s;
    }
    
    .icon-item:hover {
      transform: translateY(-5px);
      background: #e1f0ff;
    }
    
    .icon-item i {
      font-size: 24px;
      color: #4facfe;
      margin-bottom: 8px;
    }
    
    .icon-item span {
      font-size: 14px;
      color: #555;
    }
    
    .highlight-section {
      background: linear-gradient(to right, #f0f7ff, #e6f0ff);
      border: 1px solid #d1e5ff;
    }
    
    .photo-upload {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 20px;
    }
    
    .photo-preview {
      width: 150px;
      height: 150px;
      border-radius: 50%;
      border: 3px solid #4facfe;
      overflow: hidden;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #f0f7ff;
    }
    
    .photo-preview img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .photo-preview i {
      font-size: 50px;
      color: #4facfe;
    }
    
    .file-input {
      display: none;
    }
    
    .upload-btn {
      background: #4facfe;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      margin-top: 10px;
    }
    
    .upload-btn:hover {
      background: #3a8bd8;
    }
    
    /* Стили для печати */
    @media print {
      body {
        background: white;
        padding: 0;
        margin: 0;
        color: black;
      }
      
      .container {
        max-width: 100%;
        margin: 0;
        padding: 0;
      }
      
      header, .section, footer {
        box-shadow: none;
        border-radius: 0;
        margin: 0;
        padding: 15px;
      }
      
      .form-container {
        display: block;
      }
      
      .section {
        page-break-inside: avoid;
        border: 1px solid #ccc;
      }
      
      .export-buttons, .photo-upload, .remove-btn, .add-btn {
        display: none !important;
      }
      
      .row {
        display: block;
      }
      
      .row > div {
        flex: none;
        width: 100%;
        margin-bottom: 15px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1><i class="fas fa-user-graduate"></i> Конструктор резюме для школьника</h1>
      <p class="subtitle">Создайте яркое резюме, которое поможет выделиться среди других</p>
    </header>
    
    <div class="success-message" id="successMessage">
      <i class="fas fa-check-circle"></i> Резюме успешно сгенерировано! Файл загрузится автоматически.
    </div>
    
    <form id="resumeForm">
      <div class="form-container">
        <div class="left-column">
          <div class="section highlight-section">
            <h2><i class="fas fa-user"></i> Личные данные</h2>
            <div class="photo-upload">
              <div class="photo-preview" id="photoPreview">
                <i class="fas fa-user"></i>
              </div>
              <input type="file" id="photoInput" class="file-input" accept="image/*">
              <button type="button" class="upload-btn" onclick="document.getElementById('photoInput').click()">
                <i class="fas fa-upload"></i> Загрузить фото
              </button>
            </div>
            
            <div class="row">
              <div>
                <label class="required" for="fio">ФИО (полностью)</label>
                <input type="text" id="fio" name="fio" required placeholder="Иванов Иван Иванович">
                <div class="validation-message" id="fio-error">Пожалуйста, укажите ФИО</div>
              </div>
              <div>
                <label class="required" for="age">Возраст</label>
                <input type="number" id="age" name="age" min="10" max="18" required placeholder="16">
                <div class="validation-message" id="age-error">Введите корректный возраст (10-18)</div>
              </div>
            </div>
            <div class="row">
              <div>
                <label class="required" for="city">Город</label>
                <input type="text" id="city" name="city" required placeholder="Москва">
                <div class="validation-message" id="city-error">Пожалуйста, укажите город</div>
              </div>
              <div>
                <label class="required" for="phone">Телефон</label>
                <input type="tel" id="phone" name="phone" pattern="\+?[0-9\s\-\(\)]+" required placeholder="+7 (999) 123-45-67">
                <div class="validation-message" id="phone-error">Введите корректный номер телефона</div>
              </div>
            </div>
            <div class="row">
              <div>
                <label class="required" for="email">E-mail</label>
                <input type="email" id="email" name="email" required placeholder="example@email.com">
                <div class="validation-message" id="email-error">Введите корректный email</div>
              </div>
              <div>
                <label for="socials">Соцсети <span class="tooltip">(?)<span class="tooltip-text">Укажите ссылки на профили в социальных сетях</span></span></label>
                <input type="text" name="socials" placeholder="@telegram, vk.com/id123...">
              </div>
            </div>
          </div>

          <div class="section">
            <h2><i class="fas fa-school"></i> Учёба</h2>
            <label for="school">Школа</label>
            <input type="text" name="school" value="МАОУ СОШ 37" required placeholder="МБОУ СОШ №1">
            <div class="row">
              <div>
                <label for="grade">Класс</label>
                <input type="text" name="grade" value="9Б" placeholder="10А">
              </div>
              <div>
                <label for="gpa">Средний балл</label>
                <input type="number" name="gpa" step="0.1" min="1" max="5" value="4.5" placeholder="4.5">
              </div>
            </div>
            <label for="edu_desc">Дополнительная информация об учёбе</label>
            <textarea name="edu_desc" rows="2" placeholder="Участвую в олимпиадах, проектах, дополнительных занятиях...">участие в спортивных соревнованиях городского и школьного уровней</textarea>
          </div>

          <div class="section">
            <h2><i class="fas fa-trophy"></i> Достижения</h2>
            <textarea name="achievements" rows="4" placeholder="• Призёр школьной олимпиады по математике (2023)
• Участник регионального конкурса проектов (2022)
• Лучший ученик по информатике (2023)">Призёр олимпиады по биологии, участник олимпиад по истории, литературе, русскому языку, обществознанию</textarea>
          </div>
        </div>

        <div class="right-column">
          <div class="section">
            <h2><i class="fas fa-flask"></i> Научные проекты</h2>
            <div id="projectList">
              <div class="expItem">
                <button type="button" class="remove-btn" onclick="removeProject(this)"><i class="fas fa-times"></i></button>
                <label for="project_name">Название проекта</label>
                <input type="text" name="project_name" value="Разработка приложения для и..." placeholder="Разработка приложения для изучения английских слов">
                <label for="project_desc">Описание проекта</label>
                <textarea name="project_desc" rows="3" placeholder="Описание проекта, его цели и результаты...">Описание проекта, его цели и результаты...</textarea>
                <label for="project_year">Год реализации</label>
                <input type="number" name="project_year" min="2020" max="2030" value="2023" placeholder="2023">
              </div>
            </div>
            <button type="button" class="add-btn" onclick="addProject()"><i class="fas fa-plus"></i> Добавить проект</button>
          </div>

          <div class="section">
            <h2><i class="fas fa-users"></i> Волонтёрство и общественная деятельность</h2>
            <div id="volunteerList">
              <div class="courseItem">
                <button type="button" class="remove-btn" onclick="removeVolunteer(this)"><i class="fas fa-times"></i></button>
                <label for="volunteer_name">Организация / мероприятие</label>
                <input type="text" name="volunteer_name" placeholder="Экологический отряд">
                <label for="volunteer_desc">Описание деятельности</label>
                <textarea name="volunteer_desc" rows="2" placeholder="Участие в субботниках, раздельный сбор мусора..."></textarea>
              </div>
            </div>
            <button type="button" class="add-btn" onclick="addVolunteer()"><i class="fas fa-plus"></i> Добавить деятельность</button>
          </div>

          <div class="section">
            <h2><i class="fas fa-star"></i> Навыки и увлечения</h2>
            <label for="skills">Перечислите через запятую</label>
            <input type="text" name="skills" value="Баскетбол" placeholder="Программирование, рисование, английский язык, волейбол...">
            
            <label for="hobbies">Хобби и интересы</label>
            <textarea name="hobbies" rows="3" placeholder="Фотография, путешествия, чтение книг, волейбол...">Игра на гитаре, чтение книг</textarea>
          </div>

          <div class="section">
            <h2><i class="fas fa-language"></i> Знание языков</h2>
            <label for="languages">Языки и уровень владения</label>
            <input type="text" name="languages" value="Русский-родной, английский-уровень B1" placeholder="Русский – родной, Английский – B1, Немецкий – A2">
          </div>
        </div>
      </div>

      <div class="section">
        <h2><i class="fas fa-lightbulb"></i> О себе</h2>
        <label for="about">Расскажите о себе, своих целях и интересах</label>
        <textarea name="about" rows="4" placeholder="Я активный и целеустремлённый ученик 10 класса. Увлекаюсь программированием и участвую в различных конкурсах и олимпиадах. Мечтаю поступить в престижный вуз на факультет информационных технологий...">Я активная, ставлю большие цели в спорте, нравится побеждать и работать в команде. Моя цель - войти в тройку лучших команд России в категории U18</textarea>
      </div>

      <div class="export-buttons">
        <button type="button" class="pdf-btn" onclick="generatePDF()"><i class="fas fa-file-pdf"></i> Скачать PDF</button>
        <button type="button" class="word-btn" onclick="generateWord()"><i class="fas fa-file-word"></i> Скачать Word</button>
      </div>
    </form>
    
    <footer>
      <p>© 2023 Конструктор резюме для школьника | Создайте яркое резюме, которое поможет выделиться</p>
    </footer>
  </div>

  <script>
    // Глобальная переменная для хранения данных фото
    let photoData = null;
    
    // Предварительный просмотр фото
    document.getElementById('photoInput').addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(event) {
          const preview = document.getElementById('photoPreview');
          preview.innerHTML = `<img src="${event.target.result}" alt="Фото">`;
          // Сохраняем данные фото для использования при генерации резюме
          photoData = event.target.result;
        };
        reader.readAsDataURL(file);
      }
    });

    // Добавление научного проекта
    function addProject(){
      const projectList = document.getElementById('projectList');
      
      const tpl = document.createElement('div');
      tpl.className = 'expItem';
      tpl.innerHTML = `
        <button type="button" class="remove-btn" onclick="removeProject(this)"><i class="fas fa-times"></i></button>
        <hr>
        <label>Название проекта:<input name="project_name" placeholder="Разработка приложения для изучения английских слов"></label>
        <label>Описание проекта:<textarea name="project_desc" rows="3" placeholder="Описание проекта, его цели и результаты..."></textarea>
        <label>Год реализации:<input type="number" name="project_year" min="2020" max="2030" placeholder="2023"></label>
      `;
      
      projectList.appendChild(tpl);
    }

    // Добавление волонтёрской деятельности
    function addVolunteer(){
      const volunteerList = document.getElementById('volunteerList');
      
      const tpl = document.createElement('div');
      tpl.className = 'courseItem';
      tpl.innerHTML = `
        <button type="button" class="remove-btn" onclick="removeVolunteer(this)"><i class="fas fa-times"></i></button>
        <hr>
        <label>Организация / мероприятие:<input name="volunteer_name" placeholder="Экологический отряд"></label>
        <label>Описание деятельности:<textarea name="volunteer_desc" rows="2" placeholder="Участие в субботниках, раздельный сбор мусора..."></textarea>
      `;
      
      volunteerList.appendChild(tpl);
    }

    // Удаление научного проекта
    function removeProject(element) {
      if (document.querySelectorAll('.expItem').length > 1) {
        element.parentElement.remove();
      } else {
        alert('Нужно указать хотя бы один проект');
      }
    }

    // Удаление волонтёрской деятельности
    function removeVolunteer(element) {
      if (document.querySelectorAll('.courseItem').length > 1) {
        element.parentElement.remove();
      } else {
        alert('Нужно указать хотя бы одну деятельность');
      }
    }

    // Валидация формы
    function validateForm() {
      let isValid = true;
      
      // Проверка обязательных полей
      const requiredFields = [
        { id: 'fio', name: 'fio' },
        { id: 'age', name: 'age' },
        { id: 'city', name: 'city' },
        { id: 'phone', name: 'phone' },
        { id: 'email', name: 'email' }
      ];
      
      requiredFields.forEach(field => {
        const element = document.getElementById(field.id);
        const errorElement = document.getElementById(`${field.id}-error`);
        
        if (!element.value.trim()) {
          element.classList.add('error');
          errorElement.style.display = 'block';
          isValid = false;
        } else {
          element.classList.remove('error');
          errorElement.style.display = 'none';
        }
      });
      
      // Проверка возраста
      const age = document.getElementById('age');
      if (age.value && (isNaN(age.value) || age.value < 10 || age.value > 18)) {
        age.classList.add('error');
        document.getElementById('age-error').style.display = 'block';
        isValid = false;
      }
      
      return isValid;
    }

    // Генерация PDF
    async function generatePDF() {
      if (!validateForm()) {
        return;
      }
      
      // Создаем контейнер для PDF
      const pdfContainer = document.createElement('div');
      pdfContainer.id = 'pdf-content';
      pdfContainer.style.width = '210mm';
      pdfContainer.style.height = '297mm';
      pdfContainer.style.padding = '20px';
      pdfContainer.style.boxSizing = 'border-box';
      pdfContainer.style.backgroundColor = 'white';
      pdfContainer.style.color = 'black';
      pdfContainer.style.fontFamily = 'Arial, sans-serif';
      pdfContainer.style.lineHeight = '1.4';
      
      // Генерируем HTML для PDF
      const data = new FormData(document.getElementById('resumeForm'));
      if (photoData) {
        data.append('photo_data', photoData);
      }
      
      const html = generateResumeHTML(data);
      pdfContainer.innerHTML = html;
      
      // Добавляем контейнер к документу
      document.body.appendChild(pdfContainer);
      
      // Ждем, пока изображения загрузятся
      await new Promise(resolve => {
        setTimeout(resolve, 1000);
      });
      
      // Создаем PDF
      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF('p', 'mm', 'a4');
      
      // Получаем canvas из контейнера
      const canvas = await html2canvas(pdfContainer, { 
        scale: 2,
        useCORS: true,
        allowTaint: true
      });
      
      const imgData = canvas.toDataURL('image/png');
      const imgWidth = 210; // A4 width in mm
      const pageHeight = 297; // A4 height in mm
      const imgHeight = canvas.height * imgWidth / canvas.width;
      let heightLeft = imgHeight;
      let position = 0;
      
      pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
      heightLeft -= pageHeight;
      
      // Удаляем временный контейнер
      document.body.removeChild(pdfContainer);
      
      // Сохраняем PDF
      pdf.save('resume_school.pdf');
    }

    // Генерация Word документа
    function generateWord() {
      if (!validateForm()) {
        return;
      }
      
      const data = new FormData(document.getElementById('resumeForm'));
      if (photoData) {
        data.append('photo_data', photoData);
      }
      
      const html = generateResumeHTML(data);
      
      // Создаем Word документ
      const docType = '<?xml version="1.0" encoding="UTF-8"?>';
      const wordContent = `
        <html xmlns:o="urn:schemas-microsoft-com:office:office" 
              xmlns:w="urn:schemas-microsoft-com:office:word" 
              xmlns="http://www.w3.org/TR/REC-html40">
        <head>
          <meta charset="utf-8">
          <title>Резюме ${data.get('fio')}</title>
          <style>
            body { 
              font-family: Arial, sans-serif; 
              margin: 40px; 
              color: #333; 
              line-height: 1.4; 
              font-size: 12pt;
            }
            h1 { 
              margin: 0 0 10px 0; 
              font-size: 18pt; 
              color: #2c3e50; 
              border-bottom: 3px solid #4facfe; 
              padding-bottom: 10px; 
            }
            h2 { 
              margin-top: 25px; 
              font-size: 14pt; 
              color: #2980b9; 
              border-bottom: 2px solid #eee; 
              padding-bottom: 5px; 
            }
            .contacts { 
              margin-top: 10px; 
              font-size: 12pt; 
              color: #555; 
            }
            ul { 
              margin: 10px 0; 
              padding-left: 20px; 
            }
            li { 
              margin-bottom: 8px; 
            }
            .project-item, .volunteer-item { 
              margin-bottom: 15px; 
              padding: 10px; 
              background: #f8f9fa; 
              border-radius: 5px; 
            }
            .skills { 
              display: flex; 
              flex-wrap: wrap; 
              gap: 8px; 
            }
            .skill-tag { 
              background: #4facfe; 
              color: white; 
              padding: 5px 12px; 
              border-radius: 20px; 
              font-size: 10pt; 
            }
          </style>
        </head>
        <body>
          ${html}
        </body>
        </html>
      `;
      
      // Создаем Blob с Word документом
      const blob = new Blob([docType + wordContent], {
        type: 'application/msword'
      });
      
      // Создаем ссылку для скачивания
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'resume_school.doc';
      a.click();
      URL.revokeObjectURL(url);
    }

    function generateResumeHTML(data){
      const get = (name) => data.getAll(name).filter(v => v).join(', ');
      const getList = (name) => data.getAll(name).filter(v => v).map(v => `<li>${v}</li>`).join('');
      
      // Обработка проектов
      const projectNames = data.getAll('project_name');
      const projectDescs = data.getAll('project_desc');
      const projectYears = data.getAll('project_year');
      
      let projectHtml = '';
      for (let i = 0; i < projectNames.length; i++) {
        if (projectNames[i] || projectDescs[i] || projectYears[i]) {
          projectHtml += `
            <div class="project-item">
              <p><strong>${projectNames[i] || 'Не указано название'}</strong> (${projectYears[i] || 'Не указан год'})<br>
              ${projectDescs[i] || 'Нет описания'}</p>
            </div>
          `;
        }
      }
      
      // Обработка волонтёрской деятельности
      const volunteerNames = data.getAll('volunteer_name');
      const volunteerDescs = data.getAll('volunteer_desc');
      
      let volunteerHtml = '';
      for (let i = 0; i < volunteerNames.length; i++) {
        if (volunteerNames[i] || volunteerDescs[i]) {
          volunteerHtml += `
            <div class="volunteer-item">
              <p><strong>${volunteerNames[i] || 'Не указано'}</strong><br>
              ${volunteerDescs[i] || 'Нет описания'}</p>
            </div>
          `;
        }
      }
      
      // Получение фото
      const photoData = data.get('photo_data');
      let photoHtml = '';
      if (photoData) {
        photoHtml = `<img src="${photoData}" alt="Фото" style="width: 120px; height: 120px; border-radius: 50%; object-fit: cover; float: right; margin-left: 20px; border: 2px solid #4facfe;">`;
      }
      
      return `<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8">
<title>Резюме ${data.get('fio')}</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 40px;
    color: #333;
    line-height: 1.6;
    background-color: #f9f9f9;
  }
  .container {
    max-width: 800px;
    margin: 0 auto;
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0,0,0,0.1);
  }
  h1 {
    margin: 0 0 10px 0;
    font-size: 32px;
    color: #2c3e50;
    border-bottom: 3px solid #4facfe;
    padding-bottom: 10px;
  }
  h2 {
    margin-top: 30px;
    font-size: 20px;
    color: #2980b9;
    border-bottom: 2px solid #eee;
    padding-bottom: 8px;
  }
  .contacts {
    margin-top: 10px;
    font-size: 16px;
    color: #555;
  }
  ul {
    margin: 10px 0;
    padding-left: 20px;
  }
  li {
    margin-bottom: 8px;
  }
  .project-item, .volunteer-item {
    margin-bottom: 15px;
    padding: 10px;
    background: #f8f9fa;
    border-radius: 5px;
  }
  .skills {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
  }
  .skill-tag {
    background: #4facfe;
    color: white;
    padding: 5px 12px;
    border-radius: 20px;
    font-size: 14px;
  }
</style>
</head>
<body>
  <div class="container">
    <div style="display: flex; align-items: center;">
      <h1 style="flex: 1;">${data.get('fio')}</h1>
      ${photoHtml}
    </div>
    <div class="contacts">
      ${data.get('age') ? 'Возраст: ' + data.get('age') + ' лет' : ''} 
      ${data.get('city') ? ' | ' + data.get('city') : ''}
      <br>
      ${data.get('phone')} | ${data.get('email')} 
      ${data.get('socials') ? ' | ' + data.get('socials') : ''}
    </div>

    <h2>Образование</h2>
    <p><strong>${data.get('school') || 'Школа не указана'}</strong><br>
    ${data.get('grade') ? 'Класс: ' + data.get('grade') : 'Класс не указан'}<br>
    ${data.get('gpa') ? 'Средний балл: ' + data.get('gpa') : 'Средний балл не указан'}<br>
    ${data.get('edu_desc') || 'Дополнительная информация не указана'}</p>

    <h2>Научные проекты</h2>
    ${projectHtml || '<p>Проекты не указаны</p>'}

    <h2>Волонтёрство и общественная деятельность</h2>
    ${volunteerHtml || '<p>Деятельность не указана</p>'}

    <h2>Навыки и увлечения</h2>
    ${data.get('skills') ? 
    `<div class="skills">${data.get('skills').split(',').map(skill => `<span class="skill-tag">${skill.trim()}</span>`).join('')}</div>` : 
    '<p>Навыки не указаны</p>'}

    <h2>Достижения</h2>
    ${data.get('achievements') ? 
    `<p>${data.get('achievements').replace(/\n/g, '<br>')}</p>` : 
    '<p>Достижения не указаны</p>'}

    <h2>Языки</h2>
    ${data.get('languages') ? 
    `<p>${data.get('languages')}</p>` : 
    '<p>Языки не указаны</p>'}

    <h2>О себе</h2>
    ${data.get('about') ? 
    `<p>${data.get('about')}</p>` : 
    '<p>Информация о себе не указана</p>'}
  </div>
</body>
</html>`;
    }
  </script>
</body>
</html>
